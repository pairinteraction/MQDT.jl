# Isotope data
PARA = mqdt.Parameters(
    :Yb171,
    1822.88848628*170.9363258, # nuclear mass
    0.5, # nuclear spin
    109736.9635066, # Rydberg constant in 1/cm
    # 50442.795744, # lowest ionization threshold in 1/cm (Fc=0)
    50443.217463, # higher hyperfine ionization threshold in 1/cm (Fc=1)
    0.421719, # hyperfine constant in 1/cm
    # 12.64 # hyperfine constant in GHz
    0.49367 # nuclear dipole
)

# MQDT Models
MODEL_S05 = Model(
    "S F=1/2",
    7,
    ["6sns 1S0", "4f13 5d 6snl a", "6pnp 1S0", "4f13 5d 6snl b", "6pnp 3P0", "4f13 5d 6snl c", "6sns 3S1"],
    # ["(6s1/2)(ns1/2)", "5d a", "(6p3/2)(np3/2)", "5d b", "(6p1/2)(np1/2)", "5d c", "(6s1/2)(ns1/2)"],
    Bool[1, 0, 0, 0, 0, 0, 1],
    Bool[0, 0, 0, 0, 0, 0, 0], # don't use rydberg ritz for consistency with 3S1
    [50442.795744, 83967.7, 80835.39, 83967.7, 77504.98, 83967.7, 50443.217463],
    [0.357519763 0.298712849 0 0 0; 0.203907536 0 0 0 0; 0.116803536 0 0 0 0; 0.286731074 0 0 0 0; 0.248113946 0 0 0 0; 0.148678953 0 0 0 0; 0.438426851 3.91762642 -10612.6828 8017432.38 -2582622910.0],
    ["12", "13", "14", "34", "35", "16"],
    [0.131810463 0; 0.297612147 0; 0.055508821 0; 0.101030515 0; 0.102911159 0; 0.137723736 0],
    [0 0 0; 1 0 1],
    mqdt.fjChannels([0.5, 0.5], [0, 0], [0.5, 0.5], [0, 1], [0.5, 0.5], [0, 0], [0.5, 0.5], [0.5, 0.5]),
    [1/2 0 0 0 0 0 sqrt(3)/2; 0 1 0 0 0 0 0; 0 0 -sqrt(2/3) 0 sqrt(1/3) 0 0; 0 0 0 1 0 0 0; 0 0 sqrt(1/3) 0 sqrt(2/3) 0 0; 0 0 0 0 0 1 0; sqrt(3)/2 0 0 0 0 0 -1/2] # according to paper & rydcalc code
    #[1/2 0 0 0 0 0 sqrt(3)/2; 0 1 0 0 0 0 0; 0 0 sqrt(2/3) 0 sqrt(1/3) 0 0; 0 0 0 1 0 0 0; 0 0 -sqrt(1/3) 0 sqrt(2/3) 0 0; 0 0 0 0 0 1 0; sqrt(3)/2 0 0 0 0 0 -1/2] # correct frame transformation
)

MODEL_S15 = Model(
    "S F=3/2",
    1,
    ["6sns 3S1"],
    # ["(6s1/2)(ns1/2)"],
    Bool[1], 
    Bool[0], # according to energies tabulated in the paper
    #Bool[1], # according to rydcalc code
    [50443.217463],
    [0.438426851 3.91762642 -10612.6828 8017432.38 -2582622910.0],
    [""], 
    [0;;],
    [1 0 1],
    mqdt.fjChannels([0.5], [0], [0.5], [1], [0.5], [0], [0.5], [1.5]),
    [1;;]
)

MODEL_CL = Model(
    "clock",
    3,
    ["6snp 1P1", "6snp 3P1", "6snp 3P0"],
    # ["(6s1/2)(np3/2)", "(6s1/2)(np1/2)", "(6s1/2)(np1/2)"],
    Bool[1, 1, 1],
    Bool[0, 0, 0],
    [50443.217463, 50443.217463, 50442.795744],
    [0.92042596 0; 0.16108172 0; 0.18070094 0],
    [""],
    [0;;],
    [0 1 1; 1 1 1; 1 1 0],
    mqdt.fjChannels([0.5, 0.5, 0.5], [0, 0, 0], [0.5, 0.5, 0.5], [1, 1, 0],  [0.5, 0.5, 0.5], [1, 1, 1], [1.5, 0.5, 0.5], [0.5, 0.5, 0.5]),
    [-sqrt(2/3) -sqrt(1/3) 0; 1/(2sqrt(3)) -sqrt(1/6) sqrt(3)/2; -1/2 1/sqrt(2) 1/2]
)

MODEL_P05 = Model(
    "P F=1/2",
    8,
    ["6snp 1P1", "6snp 3P1", "4f13 5d 6snl a", "4f13 5d 6snl b", "4f13 5d 6snl c", "4f13 5d 6snl d", "6snp 3P0", "4f13 5d 6snl e"],
    # ["(6s1/2)(np3/2)", "(6s1/2)(np1/2)", "5d a", "5d b", "5d c", "5d d", "(6s1/2)(np1/2)", "5d e"],
    Bool[1, 1, 0, 0, 0, 0, 1, 0],
    Bool[0, 0, 0, 0, 0, 0, 0, 0],
    [50443.217463, 50443.217463, 83967.7, 83967.7, 83967.7, 83967.7, 50442.795744, 83967.7],
    [0.921706585 2.6036257; 0.979638580 -5.4562725; 0.228828720 0; 0.205484818 0; 0.193528629 0; 0.181385000 0; 0.953071282 0.131025247; 0.198445928 0],
    ["12", "27", "13", "14", "15", "16", "23", "24", "25", "26", "78"],
    [-0.087127227 135.400009 -12985.0162; -0.001430175 0 0; -0.073904060 0 0; -0.063632668 0 0; -0.021924569 0 0; -0.106678810 0 0; 0.032556999 0 0; 0.054105142 0 0; 0.086127672 0 0; 0.053804487 0 0; 0.163043619 0 0],
    [0 1 1; 1 1 1; 1 1 0],
    mqdt.fjChannels([0.5, 0.5, 0.5], [0, 0, 0], [0.5, 0.5, 0.5], [1, 1, 0],  [0.5, 0.5, 0.5], [1, 1, 1], [1.5, 0.5, 0.5], [0.5, 0.5, 0.5]),
    [-sqrt(2/3) -sqrt(1/3) 0 0 0 0 0 0; 1/(2sqrt(3)) -sqrt(1/6) 0 0 0 0 sqrt(3)/2 0; 0 0 1 0 0 0 0 0; 0 0 0 1 0 0 0 0; 0 0 0 0 1 0 0 0; 0 0 0 0 0 1 0 0; -1/2 1/sqrt(2) 0 0 0 0 1/2 0; 0 0 0 0 0 0 0 1]
)

MODEL_P15 = Model(
    "P F=3/2",
    10,
    ["6snp 1P1", "6snp 3P1", "4f13 5d 6snl a", "4f13 5d 6snl b", "4f13 5d 6snl c", "4f13 5d 6snl d", "6snp 3P2", "4f13 5d 6snl e", "4f13 5d 6snl f", "4f13 5d 6snl g"],
    # ["(6s1/2)(np3/2)", "(6s1/2)(np1/2)", "5d a", "5d b", "5d c", "5d d", "(6s1/2)(np3/2)", "5d e", "5d f", "5d g"],
    Bool[1, 1, 0, 0, 0, 0, 1, 0, 0, 0],
    Bool[0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [50443.217463, 50443.217463, 83967.7, 83967.7, 83967.7, 83967.7, 50442.795744, 83967.7, 83967.7, 83967.7],
    [0.921706585 2.56569459 0; 0.979638580 -5.239904224 0; 0.228828720 0 0; 0.205484818 0 0; 0.193528629 0 0; 0.181385000 0 0; 0.924825736 -3.542481644 81.5334687; 0.236866903 0 0; 0.221055883 0 0; 0.185599376 0 0],
    ["12", "13", "14", "15", "16", "23", "24", "25", "26", "78", "79", "710"],
    [-0.087127227 135.400009 -12985.0162; -0.073904060 0 0; -0.063632668 0 0; -0.021924569 0 0; -0.106678810 0 0; 0.032556999 0 0; 0.054105142 0 0; 0.086127672 0 0; 0.053804487 0 0; 0.071426685 0 0; 0.027464110 0 0; -0.029741862 0 0],
    [0 1 1; 1 1 1; 1 1 2],
    mqdt.fjChannels([0.5, 0.5, 0.5], [0, 0, 0], [0.5, 0.5, 0.5], [1, 1, 0],  [0.5, 0.5, 0.5], [1, 1, 1], [1.5, 0.5, 1.5], [1.5, 1.5, 1.5]),
    [sqrt(5/3)/2 sqrt(5/6)/2 0 0 0 0 -sqrt(3/2)/2 0 0 0; -sqrt(1/3) sqrt(2/3) 0 0 0 0 0 0 0 0; 0 0 1 0 0 0 0 0 0 0; 0 0 0 1 0 0 0 0 0 0; 0 0 0 0 1 0 0 0 0 0; 0 0 0 0 0 1 0 0 0 0; 1/2 1/(2sqrt(2)) 0 0 0  0 sqrt(5/2)/2 0 0 0; 0 0 0 0 0 0 0 1 0 0; 0 0 0 0 0 0 0 0 1 0; 0 0 0 0 0 0 0 0 0 1]
)

MODEL_P25 = Model(
    "P F=5/2",
    4,
    ["6snp 3P2", "4f13 5d 6snl a", "4f13 5d 6snl b", "4f13 5d 6snl c"],
    # ["(6s1/2)(np3/2)", "5d a", "5d b", "5d c"],
    Bool[1, 0, 0, 0],
    Bool[0, 0, 0, 0],
    [50443.217463, 83967.7, 83967.7, 83967.7],
    [0.924825736 -3.542481644 81.5334687; 0.236866903 0 0; 0.221055883 0 0; 0.185599376 0 0],
    ["12", "13", "14"],
    [0.071426685 0; 0.027464110 0; -0.029741862 0],
    [1 1 2],
    mqdt.fjChannels([0.5], [0], [0.5], [1], [0.5], [1], [1.5], [2.5]),
    [1 0 0 0; 0 1 0 0; 0 0 1 0; 0 0 0 1]
)

MODEL_D05 = Model(
    "D F=1/2",
    1,
    ["6snd 3D1"],
    # ["(6s1/2)(nd3/2)"],
    Bool[1], 
    Bool[0],
    [50443.21746],
    [0.75258093 0.382628525 -483.120633],
    [""], 
    [0;;],
    [1 2 1],
    mqdt.fjChannels([0.5], [0], [0.5], [1], [0.5], [2], [1.5], [0.5]),
    [1;;]
)

MODEL_D15 = Model(
    "D F=3/2",
    6,
    ["6snd 1D2", "6snd 3D2", "4f13 5d 6snl a", "4f13 5d 6snl b", "6pnp 1D2", "6snd 3D1"],
    # ["(6s1/2)(nd5/2)", "(6s1/2)(nd3/2)", "5d a", "5d b", "(6p1/2)(np1/2)", "(6s1/2)(nd3/2)"],
    Bool[1, 1, 0, 0, 0, 1], 
    Bool[0, 0, 0, 0, 0, 0],
    [50443.21746, 50443.21746, 83967.7, 83967.7, 79725.35, 50442.795744],
    [0.730537124 -0.000186828866 0; 0.751591782 -0.00114049637 0; 0.196120394 0 0; 0.233742396 0 0; 0.152905343 0 0; 0.75258093 0.382628525 -483.120633],
    ["12", "13", "14", "24", "15", "25"],
    [0.205496654 0; 0.00522401624 0; 0.0409502343 0; -0.00378075773 0; 0.108563952 0; 0.0665700438 0], 
    [0 2 2; 1 2 2; 1 2 1],
    mqdt.fjChannels([0.5, 0.5, 0.5], [0, 0, 0], [0.5, 0.5, 0.5], [1, 1, 0],  [0.5, 0.5, 0.5], [2, 2, 2], [2.5, 1.5, 1.5], [1.5, 1.5, 1.5]),
    [-sqrt(3/5) -sqrt(2/5) 0 0 0 0; sqrt(3/5)/2 -3/(2sqrt(10)) 0 0 0 sqrt(5/2)/2; 0 0 1 0 0 0; 0 0 0 1 0 0; 0 0 0 0 1 0; -1/2 sqrt(3/2)/2 0 0 0 sqrt(3/2)/2]
)

MODEL_D25 = Model(
    "D F=5/2",
    6,
    ["6snd 1D2", "6snd 3D2", "4f13 5d 6snl a", "4f13 5d 6snl b", "6pnp 1D2", "6snd 3D3"],
    # ["(6s1/2)(nd5/2)", "(6s1/2)(nd3/2)", "5d a", "5d b", "(6p1/2)(np1/2)", "(6s1/2)(nd5/2)"],
    Bool[1, 1, 0, 0, 0, 1],
    Bool[0, 0, 0, 0, 0, 0],
    [50443.21746, 50443.21746, 83967.7, 83967.7, 79725.35, 50442.795744],
    [0.730537124 -0.000186828866 0; 0.751591782 -0.00114049637 0; 0.196120394 0 0; 0.233742396 0 0; 0.152905343 0 0; 0.72895315 -0.20653489 220.484722],
    ["12", "13", "14", "24", "15", "25"],
    [0.205496654 0; 0.00522401624 0; 0.0409502343 0; -0.00378075773 0; 0.108563952 0; 0.0665700438 0],
    [0 2 2; 1 2 2; 1 2 3],
    mqdt.fjChannels([0.5, 0.5, 0.5], [0, 0, 0], [0.5, 0.5, 0.5], [1, 1, 0],  [0.5, 0.5, 0.5], [2, 2, 2], [2.5, 1.5, 2.5], [2.5, 2.5, 2.5]),
    [sqrt(7/5)/2 sqrt(7/30) 0 0 0 -sqrt(5/3)/2; -sqrt(2/5) sqrt(3/5) 0 0 0 0; 0 0 1 0 0 0; 0 0 0 1 0 0; 0 0 0 0 1 0; 1/2 sqrt(1/6) 0 0 0 sqrt(7/3)/2]
)

MODEL_D35 = Model(
    "D F=7/2",
    1,
    ["6snd 3D3"],
    # ["(6s1/2)(nd3/2)"],
    Bool[1], 
    Bool[0],
    [50443.21746],
    [0.72895315 -0.20653489 220.484722],
    [""], 
    [0;;],
    [1 2 3],
    mqdt.fjChannels([0.5], [0], [0.5], [1], [0.5], [2], [2.5], [3.5]),
    [1;;]
)
