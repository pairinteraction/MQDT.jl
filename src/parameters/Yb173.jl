module Yb173

using ..MQDT: Parameters, fModel, lsChannels, fjChannels, lsQuantumNumbers, fjQuantumNumbers, coreQuantumNumbers

export PARA,
    FMODEL_HIGHN_S15,
    FMODEL_HIGHN_S25,
    FMODEL_HIGHN_S35,
    FMODEL_HIGHN_P05,
    FMODEL_HIGHN_P15,
    FMODEL_HIGHN_P25,
    FMODEL_HIGHN_P35,
    FMODEL_HIGHN_P45

# Isotope data
THRESHOLDS = Dict(
    coreQuantumNumbers(0, 0.5, 2) => 50443.291203,
    coreQuantumNumbers(0, 0.5, 3) => 50442.941262,
    coreQuantumNumbers(1, 0.5, NaN) => 77504.98,
    coreQuantumNumbers(1, 1.5, NaN) => 80835.39,
    "4f13 5d 6s" => 83967.7,
)

PARA = Parameters(
    :Yb173,
    1822.88848628*172.938216212, # nuclear mass
    2.5, # nuclear spin
    109736.9675832, # Rydberg constant in 1/cm
    THRESHOLDS[coreQuantumNumbers(0, 0.5, 2)], # higher hyperfine ionization threshold in 1/cm (Fc=2)
    -0.116647, # hyperfine constant in 1/cm
    # 3.497 # hyperfine constant in GHz corresponding to 10.491 GHz threshold splitting
    -0.68, # nuclear dipole
    THRESHOLDS,
)

# source for hyperfine constant: J. Opt. Soc. Am. B 9, 3 (1992)
# https://opg.optica.org/josab/abstract.cfm?uri=josab-9-3-332

# source for nuclear dipole: Phys. Rev. A 102, 022810
# https://journals.aps.org/pra/abstract/10.1103/PhysRevA.102.022810

# MQDT Models
FMODEL_HIGHN_S15 = fModel(
    :Yb173,
    "S F=3/2, ν > 26",
    1.5,
    (26.0, Inf),
    ["6sns 3S1"],
    # ["(6s1/2)(ns1/2)"],
    Bool[1],
    [0.438426851 3.91762642 -10612.6828 8017432.38 -2582622910.0],
    [""],
    [0;;],
    lsChannels([lsQuantumNumbers(0.5, 1, 0, 0, 0, 1)]),
    fjChannels([fjQuantumNumbers(0.5, 0, 0.5, 2, 0, 0.5, 1.5)]),
    [-1;;],
)

FMODEL_HIGHN_S25 = fModel(
    :Yb173,
    "S F=5/2, ν > 26",
    2.5,
    (26.0, Inf),
    ["6sns 1S0", "4f13 5d 6snl a", "6pnp 1S0", "4f13 5d 6snl b", "6pnp 3P0", "4f13 5d 6snl c", "6sns 3S1"],
    # ["(6s1/2)(ns1/2)", "5d a", "(6p3/2)(np3/2)", "5d b", "(6p1/2)(np1/2)", "5d c", "(6s1/2)(ns1/2)"],
    Bool[1, 0, 1, 0, 1, 0, 1],
    [
        0.357519763 0.298712849 0 0 0;
        0.203907536 0 0 0 0;
        0.116803536 0 0 0 0;
        0.286731074 0 0 0 0;
        0.248113946 0 0 0 0;
        0.148678953 0 0 0 0;
        0.438426851 3.91762642 -10612.6828 8017432.38 -2582622910.0
    ],
    ["1.2", "1.3", "1.4", "3.4", "3.5", "1.6"],
    [
        0.131810463 0;
        0.297612147 0;
        0.055508821 0;
        0.101030515 0;
        0.102911159 0;
        0.137723736 0
    ],
    lsChannels([
        lsQuantumNumbers(0.5, 0, 0, 0, 0, 0),
        lsQuantumNumbers(0.5, 0, 1, 1, 0, 0),
        lsQuantumNumbers(0.5, 1, 1, 1, 1, 0),
        lsQuantumNumbers(0.5, 1, 0, 0, 0, 1),
    ]),
    fjChannels([
        fjQuantumNumbers(0.5, 0, 0.5, 2, 0, 0.5, 2.5),
        fjQuantumNumbers(0.5, 1, 1.5, 3, 1, 1.5, 2.5),
        fjQuantumNumbers(0.5, 1, 0.5, NaN, 1, 0.5, 2.5), # Fc of the 3P0 state could be both 2 or 3
        fjQuantumNumbers(0.5, 0, 0.5, 3, 0, 0.5, 2.5),
    ]),
    [
        sqrt(5)/2/sqrt(3) 0 0 0 0 0 sqrt(7)/2/sqrt(3);
        0 1 0 0 0 0 0;
        0 0 -sqrt(2/3) 0 sqrt(1/3) 0 0;
        0 0 0 1 0 0 0;
        0 0 sqrt(1/3) 0 sqrt(2/3) 0 0;
        0 0 0 0 0 1 0;
        sqrt(7)/2/sqrt(3) 0 0 0 0 0 -sqrt(5)/2/sqrt(3)
    ],
)

FMODEL_HIGHN_S35 = fModel(
    :Yb173,
    "S F=7/2, ν > 26",
    3.5,
    (26.0, Inf),
    ["6sns 3S1"],
    # ["(6s1/2)(ns1/2)"],
    Bool[1],
    [0.438426851 3.91762642 -10612.6828 8017432.38 -2582622910.0],
    [""],
    [0;;],
    lsChannels([lsQuantumNumbers(0.5, 1, 0, 0, 0, 1)]),
    fjChannels([fjQuantumNumbers(0.5, 0, 0.5, 3, 0, 0.5, 3.5)]),
    [1;;],
)

FMODEL_HIGHN_P05 = fModel(
    :Yb173,
    "P F=1/2, ν > 10",
    0.5,
    (10.0, Inf),
    ["6snp 3P2", "4f13 5d 6snl a", "4f13 5d 6snl b", "4f13 5d 6snl c"],
    # ["(6s1/2)(np3/2)", "5d a", "5d b", "5d c"],
    Bool[1, 0, 0, 0],
    [
        0.924825736 -3.542481644 81.5334687;
        0.236866903 0 0;
        0.221055883 0 0;
        0.185599376 0 0
    ],
    ["1.2", "1.3", "1.4"],
    [0.071426685 0; 0.027464110 0; -0.029741862 0],
    lsChannels([lsQuantumNumbers(0.5, 1, 0, 1, 1, 2)]),
    fjChannels([fjQuantumNumbers(0.5, 0, 0.5, 2, 1, 1.5, 0.5)]),
    [-1 0 0 0; 0 1 0 0; 0 0 1 0; 0 0 0 1],
)

FMODEL_HIGHN_P15 = fModel(
    :Yb173,
    "P F=3/2, ν > 10",
    1.5,
    (10.0, Inf),
    [
        "6snp 1P1",
        "6snp 3P1",
        "4f13 5d 6snl a",
        "4f13 5d 6snl b",
        "4f13 5d 6snl c",
        "4f13 5d 6snl d",
        "6snp 3P2",
        "4f13 5d 6snl e",
        "4f13 5d 6snl f",
        "4f13 5d 6snl g",
    ],
    # ["(6s1/2)(np1/2)", "(6s1/2)(np3/2)", "5d a", "5d b", "5d c", "5d d", "(6s1/2)(np3/2)", "5d e", "5d f", "5d g"],
    Bool[1, 1, 0, 0, 0, 0, 1, 0, 0, 0],
    [
        0.921706585 2.56569459 0;
        0.979638580 -5.239904224 0;
        0.228828720 0 0;
        0.205484818 0 0;
        0.193528629 0 0;
        0.181385000 0 0;
        0.924825736 -3.542481644 81.5334687;
        0.236866903 0 0;
        0.221055883 0 0;
        0.185599376 0 0
    ],
    ["1.2", "1.3", "1.4", "1.5", "1.6", "2.3", "2.4", "2.5", "2.6", "7.8", "7.9", "7.10"],
    [
        -0.087127227 135.400009 -12985.0162;
        -0.073904060 0 0;
        -0.063632668 0 0;
        -0.021924569 0 0;
        -0.106678810 0 0;
        0.032556999 0 0;
        0.054105142 0 0;
        0.086127672 0 0;
        0.053804487 0 0;
        0.071426685 0 0;
        0.027464110 0 0;
        -0.029741862 0 0
    ],
    lsChannels([
        lsQuantumNumbers(0.5, 0, 0, 1, 1, 1),
        lsQuantumNumbers(0.5, 1, 0, 1, 1, 1),
        lsQuantumNumbers(0.5, 1, 0, 1, 1, 2),
    ]),
    fjChannels([
        fjQuantumNumbers(0.5, 0, 0.5, 2, 1, 0.5, 1.5),
        fjQuantumNumbers(0.5, 0, 0.5, 2, 1, 1.5, 1.5),
        fjQuantumNumbers(0.5, 0, 0.5, 3, 1, 1.5, 1.5),
    ]),
    [
        0.57735 0.288675 0 0 0 0 0.763763 0 0 0;
        -0.816497 0.204124 0 0 0 0 0.540062 0 0 0;
        0 0 1 0 0 0 0 0 0 0;
        0 0 0 1 0 0 0 0 0 0;
        0 0 0 0 1 0 0 0 0 0;
        0 0 0 0 0 1 0 0 0 0;
        0 0.935414 0 0 0 0 -0.353553 0 0 0;
        0 0 0 0 0 0 0 1 0 0;
        0 0 0 0 0 0 0 0 1 0;
        0 0 0 0 0 0 0 0 0 1
    ]',
)

FMODEL_HIGHN_P25 = fModel(
    :Yb173,
    "P F=5/2, ν > 10",
    2.5,
    (10.0, Inf),
    [
        "6snp 1P1",
        "6snp 3P1",
        "4f13 5d 6snl a",
        "4f13 5d 6snl b",
        "4f13 5d 6snl c",
        "4f13 5d 6snl d",
        "6snp 3P0",
        "4f13 5d 6snl e",
        "6snp 3P2",
        "4f13 5d 6snl f",
        "4f13 5d 6snl g",
        "4f13 5d 6snl h",
    ],
    # ["(6s1/2)(np1/2)", "(6s1/2)(np3/2)", "5d a", "5d b", "5d c", "5d d", "(6s1/2)(np1/2)", "5d e", "(6s1/2)(np3/2)", "5d f", "5d g", "5d h"],
    Bool[1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0],
    [
        0.921706585 2.56569459 0;
        0.979638580 -5.239904224 0;
        0.228828720 0 0;
        0.205484818 0 0;
        0.193528629 0 0;
        0.181385000 0 0;
        0.95356884 -0.28602498 0;
        0.19845903 0 0;
        0.924825736 -3.542481644 81.5334687;
        0.236866903 0 0;
        0.221055883 0 0;
        0.185599376 0 0
    ],
    ["1.2", "1.3", "1.4", "1.5", "1.6", "2.3", "2.4", "2.5", "2.6", "7.8", "10.9", "11.9", "12.9"],
    [
        -0.087127227 135.400009 -12985.0162;
        -0.073904060 0 0;
        -0.063632668 0 0;
        -0.021924569 0 0;
        -0.106678810 0 0;
        0.032556999 0 0;
        0.054105142 0 0;
        0.086127672 0 0;
        0.053804487 0 0;
        0.16328854 0 0;
        -0.071426685 0 0;
        -0.027464110 0 0;
        0.029741862 0 0
    ],
    lsChannels([
        lsQuantumNumbers(0.5, 0, 0, 1, 1, 1),
        lsQuantumNumbers(0.5, 1, 0, 1, 1, 1),
        lsQuantumNumbers(0.5, 1, 0, 1, 1, 0),
        lsQuantumNumbers(0.5, 1, 0, 1, 1, 2),
    ]),
    fjChannels([
        fjQuantumNumbers(0.5, 0, 0.5, 2, 1, 0.5, 2.5),
        fjQuantumNumbers(0.5, 0, 0.5, 2, 1, 1.5, 2.5),
        fjQuantumNumbers(0.5, 0, 0.5, 3, 1, 0.5, 2.5),
        fjQuantumNumbers(0.5, 0, 0.5, 3, 1, 1.5, 2.5),
    ]),
    [
        -0.440959 -0.471405 0 0 0 0 +0.372678 0 -0.666667 0 0 0;
        +0.62361 -0.333333 0 0 0 0 -0.527046 0 -0.471405 0 0 0;
        0 0 1 0 0 0 0 0 0 0 0 0;
        0 0 0 1 0 0 0 0 0 0 0 0;
        0 0 0 0 1 0 0 0 0 0 0 0;
        0 0 0 0 0 1 0 0 0 0 0 0;
        +0.645497 0 0 0 0 0 +0.763763 0 0 0 0 0;
        0 0 0 0 0 0 0 1 0 0 0 0;
        0 -0.816497 0 0 0 0 0 0 +0.57735 0 0 0;
        0 0 0 0 0 0 0 0 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 1 0;
        0 0 0 0 0 0 0 0 0 0 0 1
    ]',
)

FMODEL_HIGHN_P35 = fModel(
    :Yb173,
    "P F=7/2, ν > 10",
    3.5,
    (10.0, Inf),
    [
        "6snp 1P1",
        "6snp 3P1",
        "4f13 5d 6snl a",
        "4f13 5d 6snl b",
        "4f13 5d 6snl c",
        "4f13 5d 6snl d",
        "6snp 3P2",
        "4f13 5d 6snl e",
        "4f13 5d 6snl f",
        "4f13 5d 6snl g",
    ],
    # ["(6s1/2)(np3/2)", "(6s1/2)(np1/2)", "5d a", "5d b", "5d c", "5d d", "(6s1/2)(np3/2)", "5d e", "5d f", "5d g"],
    Bool[1, 1, 0, 0, 0, 0, 1, 0, 0, 0],
    [
        0.921706585 2.56569459 0;
        0.979638580 -5.239904224 0;
        0.228828720 0 0;
        0.205484818 0 0;
        0.193528629 0 0;
        0.181385000 0 0;
        0.924825736 -3.542481644 81.5334687;
        0.236866903 0 0;
        0.221055883 0 0;
        0.185599376 0 0
    ],
    ["1.2", "1.3", "1.4", "1.5", "1.6", "2.3", "2.4", "2.5", "2.6", "7.8", "7.9", "7.10"],
    [
        -0.087127227 135.400009 -12985.0162;
        -0.073904060 0 0;
        -0.063632668 0 0;
        -0.021924569 0 0;
        -0.106678810 0 0;
        0.032556999 0 0;
        0.054105142 0 0;
        0.086127672 0 0;
        0.053804487 0 0;
        0.071426685 0 0;
        0.027464110 0 0;
        -0.029741862 0 0
    ],
    lsChannels([
        lsQuantumNumbers(0.5, 0, 0, 1, 1, 1),
        lsQuantumNumbers(0.5, 1, 0, 1, 1, 1),
        lsQuantumNumbers(0.5, 1, 0, 1, 1, 2),
    ]),
    fjChannels([
        fjQuantumNumbers(0.5, 0, 0.5, 2, 1, 1.5, 3.5),
        fjQuantumNumbers(0.5, 0, 0.5, 3, 1, 0.5, 3.5),
        fjQuantumNumbers(0.5, 0, 0.5, 3, 1, 1.5, 3.5),
    ]),
    [
        0.645497 -0.57735 0 0 0 0 0.5 0 0 0;
        0.456435 0.816497 0 0 0 0 0.353553 0 0 0;
        0 0 1 0 0 0 0 0 0 0;
        0 0 0 1 0 0 0 0 0 0;
        0 0 0 0 1 0 0 0 0 0;
        0 0 0 0 0 1 0 0 0 0;
        0.612372 0 0 0 0 0 -0.790569 0 0 0;
        0 0 0 0 0 0 0 1 0 0;
        0 0 0 0 0 0 0 0 1 0;
        0 0 0 0 0 0 0 0 0 1
    ]',
)

FMODEL_HIGHN_P45 = fModel(
    :Yb173,
    "P F=9/2, ν > 10",
    4.5,
    (10.0, Inf),
    ["6snp 3P2", "4f13 5d 6snl a", "4f13 5d 6snl b", "4f13 5d 6snl c"],
    # ["(6s1/2)(np3/2)", "5d a", "5d b", "5d c"],
    Bool[1, 0, 0, 0],
    [
        0.924825736 -3.542481644 81.5334687;
        0.236866903 0 0;
        0.221055883 0 0;
        0.185599376 0 0
    ],
    ["1.2", "1.3", "1.4"],
    [0.071426685 0; 0.027464110 0; -0.029741862 0],
    lsChannels([lsQuantumNumbers(0.5, 1, 0, 1, 1, 2)]),
    fjChannels([fjQuantumNumbers(0.5, 0, 0.5, 3, 1, 1.5, 4.5)]),
    [1 0 0 0; 0 1 0 0; 0 0 1 0; 0 0 0 1],
)

end
